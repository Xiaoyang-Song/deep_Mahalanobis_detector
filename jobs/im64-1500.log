Namespace(batch_size=200, dataset='imagenet10', dataroot='./data', ckpt='imagenet10-64-0-o1', nf=64, n_test=5000, outf='./output/', num_classes=10, net_type='densenet', gpu=0)
load model: densenet
load target data:  imagenet10
Training dataset size:  13000
Dataset size:  10400 2600 500
3100
get sample mean and covariance
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:70: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  data = Variable(data, volatile=True)

 Training Accuracy:(97.97%)

get Mahalanobis scores
  0%|          | 0/7 [00:00<?, ?it/s]Noise: 0.0
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:183: UserWarning: This overload of add is deprecated:
	add(Tensor input, Number alpha, Tensor other, *, Tensor out)
Consider using one of the following signatures instead:
	add(Tensor input, Tensor other, *, Number alpha, Tensor out) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1485.)
  tempInputs = torch.add(data.data, -magnitude, gradient)
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:186: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  noise_out_features = model.intermediate_forward(Variable(tempInputs, volatile=True), layer_index)
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 14%|█▍        | 1/7 [06:50<41:01, 410.33s/it](3100, 4)
(5000, 4)
Noise: 0.01
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 29%|██▊       | 2/7 [13:54<34:51, 418.26s/it](3100, 4)
(5000, 4)
Noise: 0.005
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 43%|████▎     | 3/7 [21:03<28:12, 423.25s/it](3100, 4)
(5000, 4)
Noise: 0.002
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 57%|█████▋    | 4/7 [28:07<21:11, 423.74s/it](3100, 4)
(5000, 4)
Noise: 0.0014
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 71%|███████▏  | 5/7 [35:23<14:16, 428.01s/it](3100, 4)
(5000, 4)
Noise: 0.001
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 86%|████████▌ | 6/7 [42:35<07:09, 429.47s/it](3100, 4)
(5000, 4)
Noise: 0.0005
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
100%|██████████| 7/7 [49:56<00:00, 433.07s/it]100%|██████████| 7/7 [49:56<00:00, 428.03s/it]
(3100, 4)
(5000, 4)
Namespace(net_type='densenet', ind_dset='imagenet10', nf=64, n_test=5000)
In-distribution:  imagenet10
0it [00:00, ?it/s]Out-of-distribution:  DTD
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1it [00:06,  6.96s/it]2it [00:08,  3.56s/it]3it [00:09,  2.43s/it]4it [00:10,  1.91s/it]5it [00:11,  1.65s/it]6it [00:12,  1.46s/it]6it [00:12,  2.10s/it]
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Out-of-distribution:  LSUN-C
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Out-of-distribution:  LSUN-R
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Out-of-distribution:  Places365-small
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Out-of-distribution:  iSUN
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Out-of-distribution:  svhn
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
Counter({1.0: 5000})
Counter({0.0: 3100})
Counter({0.0: 1500, 1.0: 1500})
Counter({1.0: 3500, 0.0: 1600})
1500
Testing set size: 1600, 3500
OOD dataset: DTD
IND ACC
[94. 94. 94. 94. 94. 94. 94.]
94.0
OOD ACC
[69. 49. 54. 66. 66. 67. 68.]
63.0
AUROC
[91. 86. 88. 90. 90. 91. 91.]
89.0
OOD dataset: LSUN-C
IND ACC
[93. 94. 94. 93. 94. 94. 94.]
94.0
OOD ACC
[97. 66. 89. 96. 96. 96. 97.]
91.0
AUROC
[98. 95. 98. 98. 98. 98. 98.]
98.0
OOD dataset: LSUN-R
IND ACC
[94. 94. 94. 94. 94. 94. 93.]
94.0
OOD ACC
[87. 47. 72. 85. 86. 86. 87.]
79.0
AUROC
[97. 88. 94. 96. 97. 97. 97.]
95.0
OOD dataset: Places365-small
IND ACC
[94. 95. 94. 94. 94. 94. 94.]
94.0
OOD ACC
[15.  7.  8. 13. 13. 14. 14.]
12.0
AUROC
[65. 56. 62. 64. 65. 65. 65.]
63.0
OOD dataset: iSUN
IND ACC
[94. 94. 94. 94. 94. 94. 93.]
94.0
OOD ACC
[82. 47. 69. 81. 82. 82. 83.]
75.0
AUROC
[96. 87. 93. 96. 96. 96. 96.]
94.0
OOD dataset: svhn
IND ACC
[93. 94. 94. 94. 94. 94. 93.]
94.0
OOD ACC
[78. 64. 66. 70. 68. 69. 74.]
70.0
AUROC
[95. 94. 94. 94. 94. 94. 95.]
94.0
