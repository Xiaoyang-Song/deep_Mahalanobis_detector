Namespace(batch_size=200, dataset='imagenet10', dataroot='./data', ckpt='imagenet10-64-0-o1', nf=64, outf='./output/', num_classes=10, net_type='densenet', gpu=0)
load model: densenet
load target data:  imagenet10
Training dataset size:  13000
Dataset size:  10400 2600 500
3100
get sample mean and covariance
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:70: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  data = Variable(data, volatile=True)

 Training Accuracy:(97.97%)

get Mahalanobis scores
  0%|          | 0/7 [00:00<?, ?it/s]Noise: 0.0
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:183: UserWarning: This overload of add is deprecated:
	add(Tensor input, Number alpha, Tensor other, *, Tensor out)
Consider using one of the following signatures instead:
	add(Tensor input, Tensor other, *, Number alpha, Tensor out) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1485.)
  tempInputs = torch.add(data.data, -magnitude, gradient)
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:186: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  noise_out_features = model.intermediate_forward(Variable(tempInputs, volatile=True), layer_index)
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 14%|█▍        | 1/7 [06:46<40:36, 406.16s/it](3100, 4)
(5000, 4)
Noise: 0.01
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 29%|██▊       | 2/7 [13:33<33:53, 406.71s/it](3100, 4)
(5000, 4)
Noise: 0.005
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 43%|████▎     | 3/7 [20:18<27:04, 406.06s/it](3100, 4)
(5000, 4)
Noise: 0.002
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
(3100, 4)
(5000, 4)
######################################
Testing on iSUN
Out-distribution: iSUN
(3100, 4)
(5000, 4)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
 57%|█████▋    | 4/7 [27:31<20:50, 416.73s/it](3100, 4)
(5000, 4)
Noise: 0.0014
######################################
Testing on DTD Texture
Out-distribution: DTD
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-C
Out-distribution: LSUN-C
(3100, 4)
(5000, 4)
######################################
Testing on LSUN-R
Out-distribution: LSUN-R
(3100, 4)
(5000, 4)
######################################
Testing on Places365
Out-distribution: Places365-small
