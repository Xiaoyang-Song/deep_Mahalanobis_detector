Namespace(batch_size=100, dataset='cifar10', dataroot='./data', outf='output/', num_classes=10, net_type='densenet', gpu=0, metric='original')
load model: densenet
load target data:  cifar10
Files already downloaded and verified
Files already downloaded and verified
Evaluating with original ODIN method (OOD samples are used for tuning parameters...)
Note that this is an unfaithful comparison as the paper claims using no OOD samples.
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:254: UserWarning: This overload of add is deprecated:
	add(Tensor input, Number alpha, Tensor other, *, Tensor out)
Consider using one of the following signatures instead:
	add(Tensor input, Tensor other, *, Number alpha, Tensor out) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1174.)
  tempInputs = torch.add(data.data,  -magnitude, gradient)
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:255: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  outputs = model(Variable(tempInputs, volatile=True))
Temperature: 1 / noise: 0
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
Temperature: 1 / noise: 0.0005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.24406139133117388
Temperature: 1 / noise: 0.001
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.3020592318371125
Temperature: 1 / noise: 0.0014
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.392719420021595
Temperature: 1 / noise: 0.002
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5171602653092704
Temperature: 1 / noise: 0.0024
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.578860095634737
Temperature: 1 / noise: 0.005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.7428659571186179
Temperature: 1 / noise: 0.01
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.7693583217646152
Temperature: 1 / noise: 0.05
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.0025836803948788845
Temperature: 1 / noise: 0.1
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.0012725590004627474
Temperature: 1 / noise: 0.2
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.007751041184636764
Temperature: 10 / noise: 0
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5728829245719574
Temperature: 10 / noise: 0.0005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.413735924726207
Temperature: 10 / noise: 0.001
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.40193583217646156
Temperature: 10 / noise: 0.0014
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.45330094092241247
Temperature: 10 / noise: 0.002
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5322381613450563
Temperature: 10 / noise: 0.0024
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5682554372975475
Temperature: 10 / noise: 0.005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.7008715101033471
Temperature: 10 / noise: 0.01
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.7124016658954189
Temperature: 10 / noise: 0.05
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.0028150547585994445
Temperature: 10 / noise: 0.1
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.0009254974548820183
Temperature: 10 / noise: 0.2
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.00489742403208393
Temperature: 100 / noise: 0
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5842202683942619
Temperature: 100 / noise: 0.0005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.4242634582754897
Temperature: 100 / noise: 0.001
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.4138516119080673
Temperature: 100 / noise: 0.0014
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.4622088539256517
Temperature: 100 / noise: 0.002
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5322381613450563
Temperature: 100 / noise: 0.0024
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5616612679315132
Temperature: 100 / noise: 0.005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.6720654018201451
Temperature: 100 / noise: 0.01
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.627178775258368
Temperature: 100 / noise: 0.05
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.0032778034860404537
Temperature: 100 / noise: 0.1
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.0011183094246490777
Temperature: 100 / noise: 0.2
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.005398735153478329
Temperature: 1000 / noise: 0
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5840274564244948
Temperature: 1000 / noise: 0.0005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.4247647693968841
Temperature: 1000 / noise: 0.001
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.4143143606355083
Temperature: 1000 / noise: 0.0014
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.46351997532006783
Temperature: 1000 / noise: 0.002
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5329708468301713
Temperature: 1000 / noise: 0.0024
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.5604272713250038
Temperature: 1000 / noise: 0.005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.6706385932438685
Temperature: 1000 / noise: 0.01
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.6210473546197748
Temperature: 1000 / noise: 0.05
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.003239241092086953
Temperature: 1000 / noise: 0.1
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.0011183094246490777
Temperature: 1000 / noise: 0.2
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
0.005398735153478329
Baseline method: in_distribution: cifar10==========
out_distribution: svhn
 TNR95  TNR99  AUROC  DTACC  AUIN   AUOUT 
 35.15  10.73  89.80  83.90  85.54  93.95

ODIN method: in_distribution: cifar10==========
out_distribution: svhn
 TNR95  TNR99  AUROC  DTACC  AUIN   AUOUT 
 74.29  47.56  91.82  86.93  68.00  96.97
temperature: 1
magnitude: 0.005

Traceback (most recent call last):
  File "/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/OOD_Baseline_and_ODIN.py", line 324, in <module>
    main()
  File "/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/OOD_Baseline_and_ODIN.py", line 225, in main
    print('out_distribution: ' + out_dist_list[count_out])
IndexError: list index out of range
Namespace(batch_size=200, dataset='cifar10', dataroot='./data', outf='./output/', num_classes=10, net_type='densenet', gpu=0)
load model: densenet
load target data:  cifar10
Files already downloaded and verified
Files already downloaded and verified
get sample mean and covariance
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:70: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  data = Variable(data, volatile=True)

 Training Accuracy:(100.00%)

get Mahalanobis scores
Noise: 0.0
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:183: UserWarning: This overload of add is deprecated:
	add(Tensor input, Number alpha, Tensor other, *, Tensor out)
Consider using one of the following signatures instead:
	add(Tensor input, Tensor other, *, Number alpha, Tensor out) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1174.)
  tempInputs = torch.add(data.data, -magnitude, gradient)
/gpfs/accounts/sunwbgt_root/sunwbgt98/xysong/deep_Mahalanobis_detector/lib_generation.py:186: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  noise_out_features = model.intermediate_forward(Variable(tempInputs, volatile=True), layer_index)
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
Noise: 0.01
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
Noise: 0.005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
Noise: 0.002
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
Noise: 0.0014
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
Noise: 0.001
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
Noise: 0.0005
Using downloaded and verified file: ./data/svhn-data/train_32x32.mat
Using downloaded and verified file: ./data/svhn-data/test_32x32.mat
Out-distribution: svhn
Namespace(net_type='densenet', ind_dset='cifar10')
In-distribution:  cifar10
Out-of-distribution:  svhn
in_distribution: cifar10==========
out_distribution: svhn
 TNR95  TNR99  AUROC  DTACC  AUIN   AUOUT 
 90.36 63.04  98.13  93.60  96.41  99.19
Input noise: Mahalanobis_0.005

